## 1. 기대 수명 예측
## 2. 당뇨병 진행도 예측
## 3. 연도별 국가 평균 수명 시각화
https://shrouded-skull-f2a.notion.site/Hope-e8000b78f02e43a6852eead958b10d4d

## 4-1. 얼굴 인식 후 나이 출력
먼저 머신 러닝 기반의 Haar Cascade 방식을 사용하여 얼굴 인식 및 검출을 수행하고 성별과 나이를 출력하는 코드를 작성하였다. 그런데 몇몇 예시 이미지들을 통하여 성별과 나이를 출력해 보았는데, face_2.JPG 이미지가 일반적인 남성의 얼굴 사진 이미지 임에도 불구하고 얼굴을 인식하지 못하는 상황이 발생하였다. 해결 방법을 탐색하던 와중, 딥러닝 기반의 Single Shot Multibox Detector (SSD) 방식으로 얼굴 검출 방식을 대체해 보았더니, 문제 상황이 해결되었다. 아래는 왜 얼굴 검출에서 성능의 차이가 발생하였는지에 대한 고찰이다.

### 4-2. 정의
Haar Cascade는 여러 개의 간단한 학습 가능한 특징들을 사용하여 얼굴을 검출한다. 이 특징들은 이미지의 밝기 변화를 기반으로 한 것이며, 얼굴의 경계, 눈, 코, 입 주변에서 밝기 변화가 어떻게 일어나는지를 학습한다. 즉, 해당 특징들은 이미지 내부에서 특정 패턴을 찾아내는데 사용되는 특징들로, 이미지의 작은 영역에서의 밝기 차이를 기반으로 계산된다.

Haar Cascade 방식은 도서관의 색인 카드 시스템에 비유가 가능하다. 책의 제목이나 주제별로 정리된 카드를 통해서 필요한 책을 찾아내듯이, Haar Cascade 는 미리 정의된 특징들을 통해 얼굴을 찾아낸다. 하지만 모든 책들이 완벽하게 분류되어 있지 않다면, 일부 책을 찾지 못하는 경우가 존재할 수 있다.

SSD는 훨씬 복잡한 딥러닝 모델을 사용하여 이미지에서 패턴을 인식한다. 해당 방법은 픽셀 수준에서부터 복잡한 특징을 학습하여 얼굴을 검출하는데 사용된다.

SSD 방식은 인터넷 검색 엔진에 비유가 가능하다. 수많은 웹 페이지 중에서 관련 있는 정보를 찾아내듯이, SSD는 학습된 데이터를 기반으로 다양한 조건에서도 얼굴을 정확하게 찾아낸다. 이는 더욱 다양하고 복잡한 정보를 처리할 수 있기 때문에 Haar Cascade 보다 훨씬 더 강력한 도구라고 할 수 있다.

### 4-3. 비교
1. 정확도와 속도: Haar Cascade 는 빠르게 작동하지만, 복잡한 얼굴 특징이나 다양한 조건에서의 얼굴을 인식하는 데는 한계가 존재한다. 반면 SSD는 속도는 더 느릴 수 있지만, 그 정확도는 훨씬 높다.

2. 학습 데이터의 다양성: Haar Cascade는 보통 더 적은 양의 데이터로 훈련되며, 이 데이터가 다양성을 갖지 못할 경우 인식 성능에 한계가 나타납니다. 반면, SSD는 대량의 데이터와 더 복잡한 네트워크 구조를 통해 훨씬 더 다양한 얼굴과 상황에 대해서 학습을 진행한다. 일반적으로 Haar Cascade 는 수천 개의 데이터를 통해 학습되나, SSD 방식은 수십만에서 수백만 개의 데이터를 통하여 학습된다. 또한, OpenCV 에서 제공하는 Haar Cascade 와 SSD 모델은 둘 모두, 미리 학습된 상태로 제공된다. 즉, SSD 모델이 직접 딥러닝 과정, 즉 자동으로 데이터를 수집하여 학습하는 과정을 수행할 필요가 없기 때문에, 비교적으로 빠르게 작동이 가능하다.

3. 응용 범위: Haar Cascade는 단순하고 제한된 환경에서 잘 작동하는 반면, SSD는 다양한 환경과 복잡한 시나리오에서도 얼굴을 잘 인식한다.

4. Haar Cascade 와 같은 전통적인 컴퓨터 비전 방식은 일반적으로 흑백 이미지에서 더욱 잘 작동한다. 왜냐하면 해당 방식에서는 색상 정보가 중요하지 않고, 밝기 정보에 의존하여 얼굴을 검출하기 때문이다. 반면에 SSD와 같은 대부분의 현대 딥러닝 기반 모델은 색상 정보를 유지하는 것이 중요하다. 왜냐하면 색상은 피부 톤, 머리 색, 조명 등에 대한 중요한 정보를 제공하며, 이는 성별 및 나이 추정을 하는데 유용하게 사용되기 때문이다.

### 4-4. 결론
위와 같은 차이점들 때문에, 같은 이미지에서 Haar Cascade 는 얼굴을 인식하지 못할 수도 있지만, SSD는 상대적으로 얼굴을 올바르게 인식할 가능성이 높다. 왜냐하면, SSD가 더욱 복잡한 내부 구조를 가지고 있기에 더욱 다양한 얼굴 형태와 각도, 조명 조건에 대해서 강인하기 때문이다.

## 추가 (2024/01/22)
여러가지 이미지를 통하여 머신 러닝과 딥 러닝 모델을 비교한 결과, 머신 러닝을 통한 성별 및 나이 예측은 드물게 얼굴을 검출하지 못하는 이미지들이 존재하나, 높은 정확도를 가지는 것을 확인했다. 그러나 딥러닝을 통한 성별 및 나이 예측에서는 얼굴을 검출하지 못하는 경우는 없으나, 자꾸 얼굴이 아닌 허공을 얼굴로 인식하는 문제 상황과, 거의 모든 인물을 "남성"으로 출력하는 문제 상황이 존재했다. 이를 해결하기 위하여 허공을 얼굴로 인식하는 문제는, 검출되는 얼굴의 개수에 따라서 검출 임계값을 다르게 주는 것으로 해결하였으나, 모든 성별을 남성으로 출력하는 문제는 임계값을 계속 조절해보아도 해결이 되지 않아, 기본적으로 머신 러닝을 통해서 성별 및 나이 예측을 수행하고, 머신 러닝 모델이 얼굴을 검출하지 못했을 경우에만 딥 러닝 모델을 통하여 성별 및 나이를 출력하도록 Python의 subprocess 모듈을 사용하여 프로젝트를 재구성하였다.

## ChatGpt를 사용한 외삽 예측에 있어서의 모델 고찰 (2024/02/12)
선형 회귀가 외삽(extrapolation)을 예측하는 데 있어서 상대적으로 우수할 수 있는 이유는 여러 가지입니다. 그리고 선형 회귀와 신경망 중 어떤 모델이 외삽에 더 적합한지에 대해 설명하겠습니다.

### 선형 회귀의 외삽에 대한 우수성

1. **단순성과 예측의 직관성**: 선형 회귀는 가장 단순한 형태의 회귀 분석으로, 입력 특성의 가중 합으로 출력을 예측합니다. 이 단순성은 모델이 학습한 데이터 범위를 벗어난 새로운 데이터에 대한 예측을 수행할 때, 일정한 경향성을 유지할 수 있게 합니다. 즉, 선형 관계가 있다고 가정할 때, 데이터 범위 밖의 값에 대해서도 일관된 방식으로 값을 예측할 수 있습니다.

2. **무한한 값의 예측**: 선형 회귀 모델은 기술적으로 데이터의 최대값이나 최소값에 제한되지 않으므로, 학습 데이터 범위 밖의 값을 예측하는 데 사용될 수 있습니다. 이는 특히 추세가 지속될 것으로 예상되는 시계열 데이터에 유용할 수 있습니다.

### 신경망의 외삽 능력

신경망, 특히 깊은 신경망은 복잡한 비선형 관계와 상호작용을 모델링할 수 있는 강력한 능력을 가지고 있습니다. 그러나 이 복잡성은 외삽 시 몇 가지 문제를 일으킬 수 있습니다:

1. **데이터 분포의 학습**: 신경망은 학습 데이터의 분포를 매우 잘 학습합니다. 그러나 학습 데이터 범위 밖의 새로운 데이터에 대해서는, 학습된 패턴을 바탕으로 한 추론을 넘어서는 예측을 하는 데 있어서 불확실성이 커집니다.

2. **과적합의 위험**: 신경망은 학습 데이터에 과적합되기 쉬우며, 이는 외삽 시 예측의 신뢰도를 더욱 감소시킬 수 있습니다. 과적합된 모델은 학습 데이터에는 잘 맞지만, 새로운 데이터에 대해서는 부정확한 예측을 할 수 있습니다.

### 1960~2021년 데이터를 바탕으로 2050년 예측

1960년부터 2021년까지의 데이터가 존재하고, 2050년의 기대 수명을 예측하고자 할 때, 선형 회귀와 신경망 중 어떤 모델이 더 적합한지는 다음 요소에 달려 있습니다:

- **데이터의 추세와 패턴**: 데이터에 명확한 선형 추세가 있고, 복잡한 비선형 패턴이 없다면 선형 회귀가 더 적합할 수 있습니다. 반면, 데이터에 복잡한 패턴이나 시간에 따른 비선형 변화가 포함되어 있다면, 신경망이 더 적합할 수 있습니다.
- **모델의 해석 가능성과 정확성의 균형**: 선형 회귀

는 결과를 해석하기 쉽지만, 신경망은 더 높은 정확성을 제공할 수 있지만 해석이 어려울 수 있습니다.

결론적으로, 2050년과 같이 학습 데이터 범위를 크게 벗어나는 예측을 수행할 때는, 먼저 데이터의 기본적인 추세와 패턴을 분석하고, 가능한 한 많은 도메인 지식을 모델에 통합하는 것이 중요합니다. 또한, 모델의 예측에 대한 신뢰 구간을 제공하여 예측의 불확실성을 정량화하는 것도 유용한 접근 방법이 될 수 있습니다.

## ChatGpt를 사용한 외삽 예측에 있어서의 모델 고찰 (2024/02/13)
외삽을 예측하는 데 있어서 일반 선형 회귀, 다중 선형 회귀, 그리고 다항 선형 회귀 중 어떤 것이 가장 우수한지는 주어진 데이터의 특성과 예측하려는 값의 범위, 그리고 모델이 캡처해야 하는 관계의 복잡성에 따라 달라집니다. 각 모델의 특성을 고려하여 외삽에 대한 그들의 적합성을 평가해 보겠습니다.

### 일반 선형 회귀
- **특성**: 단일 예측 변수(x)와 반응 변수(y) 간의 선형 관계를 모델링합니다.
- **적합성**: 데이터에 강한 선형 추세가 있고, 복잡한 패턴이 없을 경우 예측에 적합합니다. 외삽 시, 데이터의 기존 선형 추세를 따라 예측값을 제공합니다.

### 다중 선형 회귀
- **특성**: 두 개 이상의 예측 변수와 반응 변수 간의 선형 관계를 모델링합니다.
- **적합성**: 다수의 독립 변수가 반응 변수에 영향을 미치는 경우에 적합합니다. 외삽 시에는 모든 독립 변수의 영향을 종합적으로 고려하여 예측을 수행합니다. 데이터 간의 복잡한 상호작용이나 비선형 관계를 모델링하지 못하는 한계가 있습니다.

### 다항 선형 회귀
- **특성**: 독립 변수의 다항식을 사용하여 반응 변수와의 관계를 모델링합니다. 이는 비선형 관계를 선형 회귀 모델을 사용하여 캡처할 수 있게 합니다.
- **적합성**: 데이터 사이에 비선형 관계가 있을 때 적합합니다. 다항 회귀는 복잡한 패턴과 추세를 더 잘 캡처할 수 있으며, 이로 인해 외삽 시에도 더 정확한 예측을 제공할 가능성이 있습니다. 그러나 과적합의 위험이 있으며, 특히 고차 다항식을 사용할 경우 예측 범위가 학습 데이터 범위를 벗어날 때 예측의 신뢰성이 크게 떨어질 수 있습니다.

### 최종 선택
- 데이터에 선형 관계가 강하게 나타나면 **다중 선형 회귀**가 좋은 선택일 수 있습니다. 다중 선형 회귀는 여러 독립 변수의 영향을 고려할 수 있기 때문입니다.
- 데이터 사이에 복잡한 비선형 관계가 있고, 특히 예측하고자 하는 범위가 학습 데이터의 범위 내에 잘 맞는 비선형 패턴을 따를 경우, **다항 선형 회귀**가 더 적합할 수 있습니다. 다만, 외삽을 수행할 때는 모델의 과적합과 예측의 불확실성을 주의 깊게 고려해야 합니다.

결국, 어떤 모델이 외삽에 가장 우수할지는 예측하려는 데이터의 특성과 관계의 복잡성, 그리고 모델

이 얼마나 그 관계를 정확히 캡처할 수 있는지에 달려 있습니다. 따라서, 가능한 모델을 여러 개 시도해보고, 교차 검증과 함께 외삽 세트에서의 성능을 평가하여 가장 적합한 모델을 선택하는 것이 중요합니다.